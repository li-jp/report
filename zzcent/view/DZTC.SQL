create or replace view dztc as
select T.USER_ID,
T.USERNAME,
T.JOB_NAME,
T.STATUS,
T.INDUCTION_TIME,
T.STAR_LEVEL,
T.DEPT_ID,
T.DEPTNAME,
T.DAQUNAME,
T.DIMISSION_DATE,
T.NUM,
T.MMYJ,
T.ZLYJ,
T.DLYJ,
(T.MMYJ + T.ZLYJ + T.DLYJ) AS DMZYJ,
DMYJTC_R(T.MMYJ + T.ZLYJ + T.DLYJ, T.STAR_LEVEL, T.NUM) AS DMYJTC_R,
DMYJTC(T.MMYJ + T.ZLYJ + T.DLYJ, T.STAR_LEVEL, T.NUM) AS DMYJTC,
T.DZMMYJ,
T.DZZLYJ,
T.DZDLYJ,
(T.DZMMYJ + T.DZZLYJ + T.DZDLYJ) AS DZYJ,
DMYJTC_R(T.DZMMYJ + T.DZZLYJ + T.DZDLYJ, '', T.NUM) AS DZYJTC_R,
DMYJTC(T.DZMMYJ + T.DZZLYJ + T.DZDLYJ, '', T.NUM) AS DZYJTC
from DZZYJ t
--where VIEW_DATE.SET_DATE('2018-10') = TO_DATE('2018-10','yyyy-MM');
